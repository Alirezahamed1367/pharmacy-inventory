# ๐ ุฑุงูููุง ุงุณุชูุงุฏู ุงุฒ Database

## ๐ฏ **ูุงูโูุง ููุฌูุฏ**

### **1๏ธโฃ schema.sql** - ุงุณฺฉุฑูพุช ุงุตู
- **ูุฏู**: ุงุฌุงุฏ ฺฉุงูู ุฏุชุงุจุณ production
- **ูุญุชูุง**: 
  - ุชูุงู ุฌุฏุงูู ุจุง ุฑูุงุจุท ุตุญุญ
  - 2 ฺฉุงุฑุจุฑ ุฏุงุฆู (superadmin & admin)
  - ุณุงุณุชโูุง ุงููุช RLS
  - ุชูุงุจุน ฺฉูฺฉ
- **ุฒูุงู ุงุณุชูุงุฏู**: ุฑุงูโุงูุฏุงุฒ ุงููู ุณุณุชู

### **2๏ธโฃ reset.sql** - ุฑุณุช ฺฉุงูู
- **ูุฏู**: ูพุงฺฉ ฺฉุฑุฏู ู ุจุงุฒุณุงุฒ ฺฉุงูู ุฏุชุงุจุณ
- **ูุญุชูุง**:
  - ุญุฐู ุชูุงู ุฌุฏุงูู ู ุฏุงุฏูโูุง
  - ูพุงฺฉ ฺฉุฑุฏู policies
  - ุงุฌุฑุง ูุฌุฏุฏ schema.sql
- **ุฒูุงู ุงุณุชูุงุฏู**: ููฺฏุงู ูุงุฒ ุจู ุดุฑูุน ุงุฒ ุตูุฑ

### **3๏ธโฃ sample_data.sql** - ุฏุงุฏูโูุง ุชุณุช
- **ูุฏู**: ุงุถุงูู ฺฉุฑุฏู ุฏุงุฏูโูุง ููููู ุจุฑุง ุชุณุช
- **ูุญุชูุง**:
  - 10 ุฏุงุฑู ุฏุฑ ุฏุณุชูโูุง ูุฎุชูู
  - ููุฌูุฏ ุงูุจุงุฑ
  - ุชุญุฑฺฉุงุช ููููู
  - ุงุนูุงูุงุช
- **ุฒูุงู ุงุณุชูุงุฏู**: ุจุนุฏ ุงุฒ ูุตุจ ุจุฑุง ุชุณุช ุณุณุชู

---

## ๐ **ุฑุงูููุง ูุตุจ**

### **ูุฑุญูู 1: ูุตุจ ุงููู**
```sql
-- ุฏุฑ Supabase SQL Editor ุงุฌุฑุง ฺฉูุฏ:
\i schema.sql
```

### **ูุฑุญูู 2: ุงุถุงูู ฺฉุฑุฏู ุฏุงุฏูโูุง ุชุณุช (ุงุฎุชุงุฑ)**
```sql
-- ุจุฑุง ุชุณุช ุณุณุชู:
\i sample_data.sql
```

### **ูุฑุญูู 3: ุฑุณุช ุฏุฑ ุตูุฑุช ูุงุฒ**
```sql
-- ุจุฑุง ุดุฑูุน ูุฌุฏุฏ:
\i reset.sql
```

---

## ๐ฅ **ฺฉุงุฑุจุฑุงู ูพุดโูุฑุถ**

| ฺฉุงุฑุจุฑ | ูุงู ฺฉุงุฑุจุฑ | ุฑูุฒ ุนุจูุฑ | ููุด | ุชูุถุญุงุช |
|-------|-------------|-----------|------|---------|
| ุชูุณุนูโุฏููุฏู | `superadmin` | `A25893Aa` | Super Admin | ุนูุฑุถุง ุญุงูุฏ - ุบุฑ ูุงุจู ุญุฐู |
| ูุฏุฑ ุณุณุชู | `admin` | `password` | Admin | ูุฏุฑุช ฺฉุงุฑุจุฑุงู - ุบุฑ ูุงุจู ุญุฐู |

---

## ๐๏ธ **ุณุงุฎุชุงุฑ ุฏุชุงุจุณ**

### **ุฌุฏุงูู ุงุตู:**
- **users**: ฺฉุงุฑุจุฑุงู ุณุณุชู
- **warehouses**: ุงูุจุงุฑูุง
- **drugs**: ุงุทูุงุนุงุช ุฏุงุฑููุง
- **inventory**: ููุฌูุฏ ุงูุจุงุฑ
- **inventory_movements**: ุชุญุฑฺฉุงุช ููุฌูุฏ
- **transfers**: ุงูุชูุงูุงุช ุจู ุงูุจุงุฑ
- **notifications**: ุงุนูุงูุงุช ุณุณุชู

### **ูฺฺฏโูุง ุงููุช:**
- โ Row Level Security (RLS)
- โ ูุญุงูุธุช ุงุฒ ฺฉุงุฑุจุฑุงู ุฏุงุฆู
- โ ฺฉูุชุฑู ุฏุณุชุฑุณ ุจุฑ ุงุณุงุณ ููุด
- โ Audit trail ุจุฑุง ุชุบุฑุงุช

### **ุชูุงุจุน ฺฉูฺฉ:**
- `check_low_stock()`: ุจุฑุฑุณ ููุฌูุฏ ฺฉู
- `check_expired_drugs()`: ุจุฑุฑุณ ุฏุงุฑููุง ูููุถ
- `update_modified_column()`: ุจุฑูุฒุฑุณุงู ุฎูุฏฺฉุงุฑ timestamps

---

## ๐ง **ุนููุงุช ููุฏ**

### **ุจุฑุฑุณ ูุถุนุช ุณุณุชู:**
```sql
-- ุชุนุฏุงุฏ ฺฉุงุฑุจุฑุงู
SELECT COUNT(*) as user_count FROM users;

-- ุชุนุฏุงุฏ ุฏุงุฑููุง
SELECT COUNT(*) as drug_count FROM drugs WHERE is_active = true;

-- ููุฌูุฏ ฺฉู
SELECT SUM(quantity) as total_inventory FROM inventory;

-- ุฏุงุฑููุง ฺฉู ููุฌูุฏ
SELECT * FROM check_low_stock();

-- ุฏุงุฑููุง ูููุถ
SELECT * FROM check_expired_drugs();
```

### **ูุฏุฑุช ฺฉุงุฑุจุฑุงู:**
```sql
-- ุงุถุงูู ฺฉุฑุฏู ฺฉุงุฑุจุฑ ุฌุฏุฏ
INSERT INTO users (username, email, password_hash, full_name, role)
VALUES ('newuser', 'user@example.com', 'hashed_password', 'ูุงู ฺฉุงุฑุจุฑ', 'operator');

-- ูุนุงู/ุบุฑูุนุงู ฺฉุฑุฏู ฺฉุงุฑุจุฑ
UPDATE users SET is_active = false WHERE username = 'username';
```

### **ูุฏุฑุช ุงูุจุงุฑ:**
```sql
-- ุงุถุงูู ฺฉุฑุฏู ุงูุจุงุฑ ุฌุฏุฏ
INSERT INTO warehouses (name, code, description)
VALUES ('ุงูุจุงุฑ ุฌุฏุฏ', 'NEW', 'ุชูุถุญุงุช ุงูุจุงุฑ');

-- ุจุฑุฑุณ ููุฌูุฏ ุงูุจุงุฑ
SELECT w.name, COUNT(i.id) as items, SUM(i.quantity) as total_quantity
FROM warehouses w
LEFT JOIN inventory i ON w.id = i.warehouse_id
GROUP BY w.id, w.name;
```

---

## โ๏ธ **ูฺฉุงุช ููู**

### **ุงููุช:**
- ูุฑฺฏุฒ ุฑูุฒูุง ูุงูุน ุฑุง ุฏุฑ ฺฉุฏ commit ูฺฉูุฏ
- ฺฉุงุฑุจุฑุงู ุฏุงุฆู ูุงุจู ุญุฐู ูุณุชูุฏ
- RLS policies ูุญุงูุธุช ุงุฒ ุฏุงุฏูโูุง ูโฺฉููุฏ

### **Performance:**
- ููู ุงูุฏฺฉุณโูุง ุถุฑูุฑ ุชุนุฑู ุดุฏูโุงูุฏ
- ุงุฒ EXPLAIN ANALYZE ุจุฑุง ุจุฑุฑุณ ฺฉุงุฑุง ุงุณุชูุงุฏู ฺฉูุฏ
- ูพุดุชุจุงูโฺฏุฑ ููุธู ุงูุฌุงู ุฏูุฏ

### **Maintenance:**
- ุจูโุทูุฑ ููุธู ุงุฒ `check_expired_drugs()` ุงุณุชูุงุฏู ฺฉูุฏ
- ููุฌูุฏ ฺฉู ุฑุง ุจุง `check_low_stock()` ุจุฑุฑุณ ฺฉูุฏ
- Log ูุง ุณุณุชู ุฑุง ูพฺฏุฑ ฺฉูุฏ

---

## ๐ **ูพุดุชุจุงู**

**ุชูุณุนูโุฏููุฏู**: ุนูุฑุถุง ุญุงูุฏ  
**ุงูู**: alireza.h67@gmail.com  
**ูพุฑูฺู**: [GitHub Repository](https://github.com/Alirezahamed1367/pharmacy-inventory)

**ุชุงุฑุฎ ุขุฎุฑู ุจุฑูุฒุฑุณุงู**: ูพุงุฒ 1404